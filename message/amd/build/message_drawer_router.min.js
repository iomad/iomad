function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("core_message/message_drawer_router",["jquery","core/pubsub","core/str","core_message/message_drawer_events"],function(a,b,c,d){var e={},f={},g={CAN_RECEIVE_FOCUS:"input:not([type=\"hidden\"]), a[href], button, textarea, select, [tabindex]",ROUTES_BACK:"[data-route-back]"},h=function(c,f){var h,j=[].slice.call(arguments).some(function(a){return"frompanel"==a}),k=[].slice.call(arguments,2),l=a.Deferred().resolve().promise();Object.keys(e[c]).forEach(function(a){var b=e[c][a],d=a===f;if(d){h=b}b.parameters.forEach(function(a){if("object"!==_typeof(a)||null===a){return}a.removeClass("previous");a.attr("data-from-panel",!1);if(d){if(j){a.attr("data-from-panel",!0)}a.removeClass("hidden");a.attr("aria-hidden",!1)}else{if(!a.attr("data-in-panel")){a.addClass("hidden");a.attr("aria-hidden",!0)}else if("view-search"==f||"view-overview"==f){a.addClass("hidden");a.attr("aria-hidden",!0)}}})});if(h){if(h.onGo){l=h.onGo.apply(void 0,h.parameters.concat(k));for(var m=a(document.activeElement),n=!1,o=null,p=1,q;p<h.parameters.length;p++){q=h.parameters[p];if("object"!==_typeof(q)||null===q){continue}if(!o){o=q}if(q.has(m).length){n=!0;break}}if(!n){o.find(g.CAN_RECEIVE_FOCUS).filter(":visible").first().focus()}}}var r={route:f,params:k,renderPromise:l};b.publish(d.ROUTE_CHANGED,r);return r},i=function(b){var d=a(document.activeElement),j=h.apply(b,arguments),k=!1;if(!f[b]){f[b]=[]}f[b]=f[b].reduce(function(a,b){if(b.route===j.route){k=!0}if(!k){a.push(b)}return a},[]);var l=f[b].length,m=l?f[b][l-1]:null;if(m){for(var n=e[b][m.route],o=n.parameters,p=1;p<o.length;p++){if("object"!==_typeof(o[p])||null===o[p]){continue}o[p].addClass("previous")}m.focusElement=d;if(n.getDescription){n.getDescription.apply(null,n.parameters.concat(m.params)).then(function(a){return c.get_string("backto","core_message",a)}).then(function(a){return j.renderPromise.then(function(){e[b][j.route].parameters.forEach(function(b){if("object"!==_typeof(b)||!b){return}b.find(g.ROUTES_BACK).attr("aria-label",a)})})}).catch(function(){})}}f[b].push(j);return j};return{add:function add(a,b,c,d,f){if(!e[a]){e[a]=[]}e[a][b]={parameters:c,onGo:d,getDescription:f}},go:i,back:function back(a){if(f[a].length){f[a].pop();var b=f[a].pop();if(b){i.apply(void 0,[a,b.route].concat(b.params));window.setTimeout(function(){b.focusElement.focus()},50)}}}}});
//# sourceMappingURL=message_drawer_router.min.js.map
