define(["jquery","jqueryui","core/config","core/ajax","core/notification","core/templates"],function(a,b,c,d,e,f){return{init:function(b,g){function h(b){if(a("#prospectivelist li").remove(),!b.length)return void a("#noprospective").show();a("#noprospective").hide();var d={courses:b,wwwroot:c.wwwroot,prospective:!0};f.render("local_iomad_learningpath/prospectivelist",d).done(function(b){a("#prospectivelist").append(b)}).fail(e.exception)}function i(){var b=a("#coursefilter").val(),c=a("#category").val();d.call([{methodname:"local_iomad_learningpath_getprospectivecourses",args:{pathid:g,filter:b,category:c},done:function(a){h(a)},fail:e.exception}])}function j(b,d){a(b).find("li").remove();var g=a(b).data("groupid"),h=a(".nogroupcourses[data-groupid='"+g+"']");if(!d.length)return void h.show();h.hide();var i={courses:d,wwwroot:c.wwwroot,prospective:!1};f.render("local_iomad_learningpath/pathcourselist",i).done(function(c){a(b).append(c)}).fail(e.exception)}function k(){a(".pathcourselist").each(function(){var b=this,c=a(b).data("groupid");d.call([{methodname:"local_iomad_learningpath_getcourses",args:{pathid:g,groupid:c},done:function(a){j(b,a)},fail:e.exception}])})}function l(){a("#prospectivelist .path-delete").removeClass("fa-trash path-delete").addClass("fa-plus path-add"),a(".pathcourselist .path-add").removeClass("fa-plus path-add").addClass("fa-trash path-delete")}a('[data-toggle="tooltip"]').tooltip(),a(window).on("load",i()),a("#coursefilter").on("input",function(){i()}),a("#category").on("change",function(){i()}),a("#prospectivelist, .pathcourselist").on("mouseenter","li",function(){a(this).addClass("text-primary")}),a("#prospectivelist, .pathcourselist").on("mouseleave","li",function(){a(this).removeClass("text-primary")}),a(window).on("load",k()),a("#prospectivelist").on("click",".path-add",function(){var b=a(this).data("courseid");d.call([{methodname:"local_iomad_learningpath_addcourses",args:{pathid:g,courseids:[b]},done:function(){k(),i()},fail:e.exception}])}),a(".pathcourselist").on("click",".path-delete",function(){var b=a(this).data("courseid");d.call([{methodname:"local_iomad_learningpath_removecourses",args:{pathid:g,courseids:[b]},done:function(){k(),i()},fail:e.exception}])}),a(".pathcourselist").sortable({handle:".lphandle",connectWith:"#prospectivelist, .pathcourselist",dropOnEmpty:!0,update:function(){var b=[];a(".pathcourselist .pathbox").each(function(){var c=a(this).data("courseid"),d=a(this).parent().parent().data("groupid");b.push({courseid:c,groupid:d})}),d.call([{methodname:"local_iomad_learningpath_ordercourses",args:{pathid:g,courses:b},done:function(){},fail:e.exception}]),l()}}),a("#prospectivelist").sortable({handle:".lphandle",connectWith:".pathcourselist",dropOnEmpty:!0,update:function(){l()}})}}});